=== PDF文件: Flow Matching Ergodic Coverage.pdf ===
=== 时间: 2025-07-22 09:41:46.208565 ===

请你只输出如下JSON，所有字段都必须有，且每个“关键词”字段只允许输出一个中文词语（不能是英文，不能是多个，不能是短语，不能有逗号、分号、空格），否则视为不合格。不要输出任何解释或正文，只输出JSON。
{
  "论文标题": "",
  "研究主题关键词": "",
  "应用场景关键词": "",
  "主要方法关键词": "",
  "创新点关键词": "",
  "主要结论关键词": ""
}
内容：Flow Matching Ergodic Coverage
Max Muchen Sun, Allison Pinosky, Todd Murphey
Center for Robotics and Biosystems, Northwestern University, Evanston, IL 60208
Project website:
AbstractErgodic coverage effectively generates exploratory
behaviors for embodied agents by aligning the spatial distribution
of the agents trajectory with a target distribution, where the
difference between these two distributions is measured by the
ergodic metric. However, existing ergodic coverage methods are
constrained by the limited set of ergodic metrics available for con-
trol synthesis, fundamentally limiting their performance. In this
based on flow matching, a technique widely used in generative
inference for efficient and scalable sampling. We formally derive
the flow matching problem for ergodic coverage and show that
it is equivalent to a linear quadratic regulator problem with a
closed-form solution. Our formulation enables alternative ergodic
metrics from generative inference that overcome the limitations of
existing ones. These metrics were previously infeasible for control
synthesis but can now be supported with no computational
overhead. Specifically, flow matching with the Stein variational
gradient flow enables control synthesis directly over the score
function of the target distribution, improving robustness to the
unnormalized distributions; on the other hand, flow matching
with the Sinkhorn divergence flow enables an optimal transport-
based ergodic metric, improving coverage performance on non-
smooth distributions with irregular supports. We validate the
improved performance and competitive computational efficiency
of our method through comprehensive numerical benchmarks
and across different nonlinear dynamics. We further demonstrate
the practicality of our method through a series of drawing and
erasing tasks on a Franka robot.
I. INTRODUCTION
Many robotic tasks, such as search and rescue , wildlife
generate motions to explore spatial distributions like thermal
Exploration over distributions is challenging, as robots must
prioritize high-density regions while also investigating lower-
density areas. To address the long-horizon and non-myopic na-
ture of exploration tasks, ergodic coverage generates optimized
trajectories whose spatial distribution aligns with the target
of coverage that is crucial for exploration tasks. Over the past
tile sensing [2, 3], learning from demonstrations [23, 45, 48],
shared control [12, 13], and embodied active learning [40, 42].
Ergodic coverage solves an optimization problem that min-
imizes the ergodic metric, which measures the difference
between the empirical spatial distribution of the trajectory
and the target distribution , while respecting the agents
dynamic constraints. Existing methods are often based on stan-
dard trajectory optimization techniques, such as projection-
based methods  and augmented Lagrange multiplier meth-
ods . However, to be compatible with standard trajectory
optimization methods, the ergodic metric, even though it
evaluates the difference between distributions, must be defined
over trajectories. It must also be explicitly formulated and
differentiated as runtime cost function. As a result, existing
ergodic metrics, such as the most commonly used Fourier
ergodic metric  and recently developed kernel-based met-
rics [17, 48], need to be derived specifically to meet this
requirement. On the other hand, commonly used statistical
measures in machine learning, such as Kullback-Leibler diver-
gence and optimal transport metrics, are infeasible as the er-
godic metric for control synthesis using the standard trajectory
optimization methods. This limitation fundamentally restricts
the performance of existing ergodic coverage methods.
From a different perspective, ergodic coverage can also be
viewed as a sampling process: generating ergodic trajecto-
ries resembles sampling from the target distribution, where
the samples are constrained spatially and temporally under
the embodied agents dynamics. Recently, continuous flow-
based sampling approaches, such as score function-based
sampling [29, 47] and continuous normalizing flows ,
have gained significant attention due to their accuracy and
computational efficiency, as well as their compatibility with
a wide range of statistical discrepancy measures, such as
the Kullback-Leibler (KL) divergence  and optimal trans-
port metrics . Furthermore, the flow matching method
from Lipman et al.  enables scalable and efficient opti-
mization of a parameterized flow model based on a reference
eling [41, 49].
In this work, we bring the advantages of flow-based sam-
pling and flow matching to ergodic coverage to overcome the
limitations of existing ergodic metrics and trajectory optimiza-
tion methods. Our main contributions are twofold:
1) We formally derive the flow matching problem from Lip-
man et al.  for ergodic coverage and show that it is
equivalent to a linear quadratic regulator (LQR) problem.
This theoretical result leads to a closed-form iterative
optimization algorithm for generating ergodic trajectories
with a reference flow from existing flow-based sampling
methods (see Fig. 1).
2) We derive three reference flows for ergodic coverage: the
standard Fourier ergodic metric , the Stein variational
gradient flow , and the Sinkhorn divergence flow .
Update Samples
Current Samples
Target Distribution
Final Trajectory
Flow Matching
Current Trajectory
Target Distribution
Flow-based generative inference
(Ours) Flow matching ergodic coverage
Construct Flow
Final Samples
(Repeat)
Construct Flow
(Repeat)
Fig. 1: Similarity between flow-based generative inference and flow matching ergodic coverage.
We show that our method is compatible with the standard
ergodic metric and enables alternative ergodic metrics
previously infeasible for control synthesis without com-
putational overhead. Compared to state-of-the-art meth-
ergodic coverage over unnormalized distributions and
distributions with irregular supports.
a series of drawing and erasing tasks similar to [30, 6]. The
code of our implementations and videos of the experiments can
be found at our project website:
lqr-flow-matching.
II. PRELIMINARIES AND RELATED WORK
A. Notation
We denote an n-dimensional search space as X Rn. The
trajectory of the agent is defined as a mapping s : [0, T] 7X,
where T is the time horizon of the trajectory. The trajectory
is governed by the agents dynamics, s(t)  f(s(t), u(t)),
with u(t) U Rm as the control. The probability density
function of the target distribution is denoted as q : X 7R
We denote the space of all probability distributions over the
domain X as P.
B. Overiew of ergodic coverage
The goal of ergodic coverage is to match the spatial distri-
bution of the robot trajectory s(t) with the target distribution
q(x). The spatial distribution of a trajectory is defined by
extending the definition of empirical distribution.
Definition 1 (Trajectory empirical distribution). Given a tra-
jectory s(t), the associated empirical distribution is:
p[s](x)  1
(x s(t))dt,
where (x) is a Dirac delta function with the following inner
product property:
(xs)f(x)dx  f(s), s X, f C(X),
the set C(X) contains all continuous functions over X.
Note that the Dirac delta function (x) is often heuristically
represented as a point-wise mapping:
, if x  0,
But the Dirac delta function is formally a generalized function
(also called a distribution) that is not defined as a point-wise
mapping but based on the inner product property shown in
Definition 2 (Ergodic system [38, 52]). A dynamic system s(t)
is ergodic with respect to q(x) if and only if:
g(x)dp[s](x)
g(x)dq(x), g C(X).
Lemma 1. A necessary condition for Definition 2 is:
T p[s](x)  q(x), x X.
Definition 3 (Discrepancy measure). A discrepancy measure
0 is a non-negative functional, such that
D(p(x), q(x))  0 if and only if p(x)  q(x), x X.
Definition 4 (Ergodic metric). Given a discrepancy measure
0 is defined as:
E(s(t), q(x))  D(p[s](x), q(x)).
Lemma 2. Based on Lemma 1, a necessary condition for
Definition 2 is:
T E(s(t), q(x))  0.
Note that an exact ergodic system exists only at the limit of
infinite time horizon. In practice, however, ergodic coverage
approximately synthesizes an ergodic system with finite time
horizon T through the following optimization problem.
Definition 5 (Ergodic coverage).
u(t) arg min
E(s(t), q(x)),
s.t. s(t)  s0
0 f(s(t), u(t))dt, t[0, T].
Solving (8) is not easy for two main reasons. First, many com-
monly used discrepancy measures, such as the KL-divergence,
are computationally intractable to evaluate and optimize di-
rectly. This issue is further complicated by the fact that p[s]
is an empirical distributionwhere the Dirac delta function
cannot be evaluated numericallyand the target distribution
q(x) in practice is often represented not as a standard prob-
ability density function, but instead in other forms such as
unnormalized utility functions, samples, or discrete density
grids. Second, optimization of the ergodic metric must respect
the dynamics constraints of the system, and system dynamics
can be highly nonlinear in practice, which introduces extra
computational challenges.
In the next section, we will review existing ergodic metrics
and the corresponding control synthesis methods, focusing on
how they address these challenges and their limitations.
C. Review of existing ergodic coverage methods
distance using Fourier basis functions, which we name the
Fourier ergodic metric. This formula offers a computationally
tractable approximation of the ergodic metric for numerical
optimization by truncating a finite number of Fourier basis
functions. A closed-form model predictive control formula
with an infinitesimally small planning horizon is proposed to
approximate a solution to the constrained trajectory optimiza-
tion problem. However, this method does not generate optimal
ergodic coverage trajectories with a fixed time horizon, which
is crucial for practical application
